<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
    <title>WebStorage</title>
    <link rel="icon" href="https://mcj.life/logo.png">
    <link rel="stylesheet" href="css/main.css">
    <link rel="stylesheet" href="css/navigation.css">
    <link rel="stylesheet" href="css/goods.css">
    <link rel="stylesheet" href="css/config.css">
</head>
<body>
    <header class="header">
        <div class="logo"><img src="https://mcj.life/logo.png" alt="Logo"></div>
        <div class="header-btns">
            <button id="manageBtn" onclick="toggleManageMode()">编辑</button>
            <button onclick="openItemModal()" class="primary-btn">新增</button>
            <button onclick="openAdminModal()" class="ghost-btn">配置</button>
        </div>
    </header>

    <div class="main-layout">
        <aside class="side-nav" id="sideNav"></aside>
        <main class="content-view">
            <nav class="sub-nav" id="subNav"></nav>
            <div class="item-grid" id="itemGrid"></div>
        </main>
    </div>

    <div id="itemModal" class="modal">
        <div class="modal-card">
            <div class="modal-header" style="text-align:center; font-weight:bold; margin-bottom:15px; font-size:18px;">物品登记</div>
            <form id="itemForm">
                <input type="hidden" id="editItemId">
                
                <div class="flex-row" style="margin-bottom:10px">
                    <input type="text" name="name" id="formName" placeholder="名称" required>
                    <input type="text" name="notes" id="formNotes" placeholder="备注">
                </div>

                <div class="flex-row" style="margin-bottom:10px">
                    <input type="text" name="brand" id="formBrand" placeholder="品牌">
                    <input type="text" name="spec" id="formSpec" placeholder="规格">
                    <input type="text" name="quantity" id="formQty" placeholder="数量">
                </div>

                <div class="flex-row" style="margin-bottom:10px">
                    <select id="sel1" name="cat1" required></select>
                    <select id="sel2" name="cat2"></select>
                </div>

                <div class="flex-row" style="margin-bottom:10px">
                    <select id="locSel1"></select>
                    <select id="locSel2"></select>
                    <select id="locSel3"></select>
                </div>

                <div style="margin-bottom:10px">
                    <input type="text" name="imageUrl" id="formImg" placeholder="图片链接">
                </div>

                <div style="margin-bottom:10px">
                    <div style="font-size: 11px; color: #999; margin-bottom: 5px; padding-left: 5px;">或者上传本地图片：</div>
                    <input type="file" id="fileInput" accept="image/*">
                </div>
                
                <div class="modal-footer">
                    <button type="button" class="btn-cancel" onclick="toggleModal('itemModal', false)">取消</button>
                    <button type="submit" class="btn-submit">确认提交</button>
                </div>
            </form>
        </div>
    </div>

    <div id="adminModal" class="modal">
        <div class="modal-card">
            <div class="admin-tabs">
                <button onclick="switchTab('cat')" id="tabCat" class="active">分类</button>
                <button onclick="switchTab('loc')" id="tabLoc">位置</button>
            </div>
            <div id="catPanel">
                <div class="flex-row">
                    <input type="text" id="newCatName" placeholder="名称">
                    <select id="newCatLevel" onchange="updateParentOptions('cat')">
                        <option value="1">一级</option><option value="2">二级</option>
                    </select>
                </div>
                <select id="parentSelect" style="display:none; margin-top:5px;"></select>
                <button onclick="handleAddCategory()" class="btn-orange">添加</button>
                <div id="catList" class="data-list"></div>
            </div>
            <div id="locPanel" style="display:none">
                <input type="text" id="newLocName" placeholder="位置">
                <div class="flex-row" style="margin-top:5px">
                    <select id="newLocLevel" onchange="updateParentOptions('loc')">
                        <option value="1">一级</option><option value="2">二级</option><option value="3">三级</option>
                    </select>
                    <select id="locP1" onchange="loadLocChildren('locP1','locP2')" style="display:none"></select>
                    <select id="locP2" style="display:none"></select>
                </div>
                <button onclick="handleAddLocation()" class="btn-orange">添加</button>
                <div id="locList" class="data-list"></div>
            </div>
            <button onclick="toggleModal('adminModal', false)" style="width:100%; margin-top:15px; padding:12px; border:none; border-radius:14px; background:#f0f0f2;">关闭</button>
        </div>
    </div>
    <script src="js/main.js"></script>
    <script src="js/navigation.js"></script>
    <script src="js/goods.js"></script>
    <script src="js/config.js"></script>
</body>
</html>